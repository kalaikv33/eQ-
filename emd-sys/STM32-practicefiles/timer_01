#include<stm32f10x.h>


int timer(unsigned int );

int main()
{
	RCC->APB2ENR |= RCC_APB2ENR_IOPBEN;
	RCC->APB1ENR |= RCC_APB1ENR_TIM2EN;
	GPIOB->CRL = 0X00200000;
	
	TIM2->CR1 = 0X1; // en arpe bit
	TIM2->CNT = 0;
	TIM2->ARR = 7200-1;
	TIM2->PSC = 10000;
	//TIM2->SR = 0X1;

	while(1)
	{
		GPIOB->ODR= (1<<5);    //(0X01000000);
		timer(2);
		GPIOB->BRR= (1<<5);    //(0X01000000);
		timer(2);
		//GPIOC->ODR=(1<<10);
	}
}

int timer(unsigned int a)
{
	int sec = 0;
	while(a > sec)
	{
	if(TIM2->SR&0X01)
	{
		sec++;
		TIM2->SR=0;
		}
  }
}
